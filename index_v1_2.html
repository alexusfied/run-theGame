<!DOCTYPE html>
<html lang="de-DE">
  <head>
    <meta charset="utf-8" />
    <title>Run for it!</title>
    <style>
      * {
        padding: 0;
        margin: 0;
      }

      canvas {
        background: #eee;
        position: relative;
        left: 33%;
        margin-top: 10%;
      }
    </style>
  </head>

  <body>
    <canvas id="myCanvas" height="600" width="800"></canvas>

    <script>
      // Necessary variables are defined
      const canvas = document.getElementById("myCanvas");
      const ctx = canvas.getContext("2d");
      let upPressed = false;
      let downPressed = false;
      let leftPressed = false;
      let rightPressed = false;

      // The Ball class is declared, which will serve as the blueprint for all the balls that appear in the game
      class Ball {
        constructor(posX, posY, color, radius, moveX, moveY) {
          this.posX = posX;
          this.posY = posY;
          this.color = color;
          this.radius = radius;
          this.moveX = moveX;
          this.moveY = moveY;
        }
        // The drawBall method draws the ball itself on the canvas using the ball properties defined in the constructor method
        drawBall() {
          ctx.beginPath();
          ctx.arc(this.posX, this.posY, this.radius, 0, Math.PI * 2);
          ctx.fillStyle = this.color;
          ctx.fill();
          ctx.closePath();
          this.posX += this.moveX;
          this.posY += this.moveY;
        }
        // The move method lets the ball move inside of the boundaries of the canvas
        move() {
          this.drawBall();
          if (
            this.posX + this.moveX > canvas.width - this.radius ||
            this.posX + this.moveX < this.radius
          ) {
            this.moveX = -this.moveX;
          }

          if (
            this.posY + this.moveY > canvas.height - this.radius ||
            this.posY + this.moveY < this.radius
          ) {
            this.moveY = -this.moveY;
          }
        }
      }

      // Here, the objects from the Ball class are initialized
      const greenBall = new Ball(100, 100, "#0f9123", 20, 3, 6);
      const blueBall = new Ball(400, 500, "#181c5e", 30, 2, -2);
      const purpleBall = new Ball(300, 125, "#4c1d3f", 40, 8, -3);

      // The player object represents the avatar of the player
      const player = {
        posX: canvas.width / 2,
        posY: canvas.height / 2,
        pHeight: 25,
        pWidth: 25,
        // The draw player method draws the avatar of the player, in this case a black rectangle
        drawPlayer: function () {
          ctx.beginPath();
          ctx.rect(this.posX, this.posY, this.pHeight, this.pWidth);
          ctx.fillStyle = "#020100";
          ctx.fill();
          ctx.closePath();
        },
        // The play method lets the player move his avatar with the arrow keys
        play: function () {
          this.drawPlayer();
          if (upPressed) {
            this.posY -= 6;
          } else if (downPressed) {
            this.posY += 6;
          } else if (leftPressed) {
            this.posX -= 6;
          } else if (rightPressed) {
            this.posX += 6;
          }
        },
      };

      // This is the main method, which calls all the other methods necessary for playing the game
      function drawMain() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        greenBall.move();
        blueBall.move();
        purpleBall.move();
        player.play();
        requestAnimationFrame(drawMain);
      }

      // Event listeners are added, together with the corresponding functions below, so key events (only arrow keys in this case) are caught
      document.addEventListener("keydown", keyDownHandler, false);
      document.addEventListener("keyup", keyUpHandler, false);

      function keyDownHandler(e) {
        if (e.key === "Up" || e.key === "ArrowUp") {
          upPressed = true;
        } else if (e.key === "Down" || e.key === "ArrowDown") {
          downPressed = true;
        } else if (e.key === "Left" || e.key === "ArrowLeft") {
          leftPressed = true;
        } else if (e.key === "Right" || e.key === "ArrowRight") {
          rightPressed = true;
        }
      }

      function keyUpHandler(e) {
        if (e.key === "Up" || e.key === "ArrowUp") {
          upPressed = false;
        } else if (e.key === "Down" || e.key === "ArrowDown") {
          downPressed = false;
        } else if (e.key === "Left" || e.key === "ArrowLeft") {
          leftPressed = false;
        } else if (e.key === "Right" || e.key === "ArrowRight") {
          rightPressed = false;
        }
      }

      // The main function is called
      drawMain();
    </script>
  </body>
</html>
